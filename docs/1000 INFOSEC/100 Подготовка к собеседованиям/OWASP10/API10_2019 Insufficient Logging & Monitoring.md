---
title: API10-2019 Insufficient Logging & Monitoring
draft: true
tags:
  - infosec
  - OWASP
info:
---

**API10:2019** **Insufficient** **Logging &** **Monitoring** (Недостатки журналирования и мониторинга)

“_Недостаточное журналирование и мониторинг в сочетании с отсутствующей или неэффективной интеграцией с реагированием на инциденты позволяет злоумышленникам продолжать атаковать системы, сохранять присутствие, переключаться на большее количество систем для извлечения, искажения или уничтожения данных. Большинство исследований показывают, что время обнаружения нарушения составляет более 200 дней, и обычно обнаруживается внешними сторонами, а не внутренними процессами или мониторингом_.”

API уязвим, если:

- Не пишутся логи, уровень логирования некорректно установлен, или сообщения в логах недостаточно детальны.

- Не обеспечивается целостность логов (например, возможность инъекции в журнал).

- Логи не подвергаются постоянному мониторингу.

- API не подвергается постоянному мониторингу.

Примеры сценариев атаки:

1) Ключ доступа к административному API утек через общедоступный репозиторий. Владелец репозитория был уведомлен о потенциальной утечке по электронной почте, но отреагировал на инцидент более чем через 48 часов, в связи с чем утечка ключей могла привести к получению доступа к критичным данным. Из-за недостаточного логирования компания не в состоянии оценить, к каким данным злоумышленники смогли получить доступ.

2) Платформа обмена видео подверглась масштабной атаке по перебору учетных данных. Несмотря на логирование неуспешных попыток входа, уведомление об атаке не последовало в течение всего хода атаки. Логи были проанализированы и атака обнаружена только во время анализа обращения пользователя. Компании пришлось публично попросить пользователей сменить пароли и отправить отчет об атаке в регулирующие органы.

Как предотвратить:

- Логируйте все неудачные попытки входа, отказы в доступе и ошибки валидации входящих данных.

- Логи должны быть представлены в формате, позволяющем обрабатывать их с помощью систем управления логами, и должны включать достаточное количество деталей, позволяющих идентифицировать злоумышленника.

- Логи должны считаться критичными данными, а их целостность должна быть обеспечена при передаче и хранении.

- Настройте систему мониторинга для постоянного контроля инфраструктуры, сети и функционирующих API.

- Используйте систему управления информацией и событиями безопасности (SIEM), чтобы агрегировать и управлять логами всех компонентов на всех уровнях и хостах API.

- Настройте персональные уведомления и панели управления для скорейшего обнаружения и реагирования на подозрительную активность.

___
