---
title: Как JavaScript-код выполняется в движке V8? В чем разница между интерпретацией и компиляцией?
draft: false
tags:
  - NodeJS
  - V8
  - AST
  - Ignition
  - Turbofan
  - garbage-collector
info:
---
JavaScript-код в движке **V8** выполняется с использованием **Just-In-Time (JIT) компиляции**, которая сочетает преимущества интерпретации и компиляции.

**Как V8 выполняет JavaScript-код?**

1. **Парсинг и создание AST (Abstract Syntax Tree)**
    - Исходный код **разбирается (парсится)** и превращается в **абстрактное синтаксическое дерево (AST)**.
      
2. **Генерация байт-кода (Ignition)**
    - AST передается **интерпретатору Ignition**, который превращает его в **байт-код** для быстрого выполнения.
    
3. **Оптимизация и компиляция в машинный код (Turbofan)**
    - Часто используемые функции анализируются и **компилируются в машинный код** с помощью оптимизирующего компилятора **Turbofan**.
    - Это значительно ускоряет выполнение кода по сравнению с обычной интерпретацией.
    
4. **Сборка мусора (Garbage Collection)**
    - V8 автоматически очищает память с помощью **многопоточного сборщика мусора Orinoco**, который удаляет неиспользуемые объекты.

**Разница между интерпретацией и компиляцией**

|                          | Интерпретация                                  | Компиляция                                                     |
| ------------------------ | ---------------------------------------------- | -------------------------------------------------------------- |
| **Как выполняется код?** | Строчка за строчкой                            | Сначала весь код переводится в машинный код, затем выполняется |
| **Скорость старта**      | Быстрая (не требует предварительной обработки) | Медленнее (т.к. нужен процесс компиляции)                      |
| **Скорость выполнения**  | Медленнее (код интерпретируется на лету)       | Быстрее (машинный код выполняется напрямую)                    |
| **Примеры языков**       | JavaScript (в чистом виде), Python             | C, C++, Rust                                                   |

**Как V8 сочетает оба подхода?**
- Сначала **Ignition** интерпретирует JavaScript-код, чтобы быстро начать выполнение.
- Затем **Turbofan** анализирует часто вызываемые функции и компилирует их в **машинный код**, улучшая производительность.

**Вывод:** V8 использует **JIT-компиляцию**, которая объединяет плюсы интерпретации (быстрый старт) и компиляции (высокая скорость выполнения).