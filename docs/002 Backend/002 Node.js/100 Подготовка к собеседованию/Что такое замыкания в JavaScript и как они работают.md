---
title: Что такое замыкания в JavaScript и как они работают
draft: false
tags:
  - "#JavaScript"
  - "#замыкания"
  - "#closure"
  - "#область-видимости"
  - "#лексическое-окружение"
info:
  - https://learn.javascript.ru/closure
  - https://developer.mozilla.org/ru/docs/Web/JavaScript/Closures
  - https://habr.com/ru/post/474852/
---

**Замыкание (closure)** - это комбинация функции и лексического окружения, в котором эта функция была определена. Другими словами, это функция, которая запоминает свое внешнее окружение.

### Как работают замыкания

Замыкания в JavaScript основаны на двух ключевых концепциях:

1. **Лексическое окружение** - среда, содержащая все локальные переменные, доступные в месте определения функции
2. **Область видимости (scope)** - регион кода, в котором переменная доступна
3. **Цепочка областей видимости** - последовательность вложенных окружений от текущего до глобального

### Основные характеристики замыканий:

1. **Функция имеет доступ к переменным из внешних областей видимости**
2. **Переменные внешней функции сохраняются, даже когда внешняя функция завершает работу**
3. **Внутренняя функция может изменять переменные внешней функции**

### Пример простого замыкания:

```javascript
function createCounter() {
  let count = 0 // Переменная во внешней функции

  return function () {
    count++ // Внутренняя функция имеет доступ к переменной внешней функции
    return count
  }
}

const counter = createCounter()
console.log(counter()) // 1
console.log(counter()) // 2
console.log(counter()) // 3
```

В этом примере:

- Функция `createCounter()` создает переменную `count`
- Возвращается анонимная функция, которая замыкает в себе эту переменную
- Каждый вызов `counter()` увеличивает счетчик, и переменная `count` сохраняется между вызовами

### Практическое применение замыканий:

1. **Инкапсуляция данных и состояния** - создание приватных переменных:

```javascript
function createUser(name) {
  // Приватная переменная
  let secretToken = "xyz123"

  return {
    getName: function () {
      return name
    },
    authenticate: function (token) {
      return token === secretToken
    },
  }
}

const user = createUser("Анна")
console.log(user.getName()) // "Анна"
console.log(user.authenticate("xyz123")) // true
console.log(user.secretToken) // undefined - переменная недоступна снаружи
```

2. **Создание фабрик функций** - генерация специализированных функций:

```javascript
function multiplier(factor) {
  return function (number) {
    return number * factor
  }
}

const double = multiplier(2)
const triple = multiplier(3)

console.log(double(5)) // 10
console.log(triple(5)) // 15
```

### Важные особенности замыканий в Node.js

1. Замыкания активно используются в асинхронном коде Node.js для сохранения контекста
2. Помогают избежать проблем с областями видимости в коллбэках
3. Являются основой для многих паттернов, включая модульность

Замыкания - одна из мощнейших и фундаментальных концепций JavaScript, которая широко используется в Node.js и серверной разработке.

---

[[003 JSCore|Назад]]
