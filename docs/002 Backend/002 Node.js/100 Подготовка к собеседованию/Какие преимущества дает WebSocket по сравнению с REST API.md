---
title: Какие преимущества дает WebSocket по сравнению с REST API
draft: false
tags:
  - "#NodeJS"
  - "#WebSocket"
  - "#RESTAPI"
  - "#realtime"
  - "#протоколы"
  - "#коммуникация"
info:
  - "[Документация WebSocket](https://developer.mozilla.org/ru/docs/Web/API/WebSockets_API)"
  - "[Документация Socket.io](https://socket.io/docs/v4/)"
  - "[Сравнение REST и WebSocket](https://www.pubnub.com/blog/websockets-vs-rest-api-understanding-the-difference/)"
---

# Преимущества WebSocket по сравнению с REST API

WebSocket и REST API представляют собой разные технологии для обмена данными между клиентом и сервером, каждая со своими особенностями и областями применения. Вот основные преимущества WebSocket по сравнению с REST API:

## 1. Двусторонняя связь в реальном времени

### WebSocket

- **Двунаправленная коммуникация**: После установления соединения данные могут передаваться как от клиента к серверу, так и от сервера к клиенту.
- **Push-уведомления**: Сервер может отправлять данные клиенту в любой момент без запроса с его стороны.

### REST API

- **Односторонняя коммуникация**: Клиент всегда инициирует запрос, а сервер только отвечает.
- **Необходимость опроса**: Для получения обновлений клиент должен периодически запрашивать сервер (polling).

**Пример WebSocket в Node.js** (с использованием Socket.io):

```javascript
// Сервер
const io = require("socket.io")(server)

io.on("connection", (socket) => {
  console.log("Клиент подключен")

  // Отправка данных клиенту
  socket.emit("update", { data: "Новые данные" })

  // Получение данных от клиента
  socket.on("message", (data) => {
    console.log("Получено от клиента:", data)
  })
})

// Клиент
const socket = io()

// Получение данных от сервера
socket.on("update", (data) => {
  console.log("Обновление от сервера:", data)
})

// Отправка данных серверу
socket.emit("message", { text: "Привет, сервер!" })
```

## 2. Меньшая задержка и накладные расходы

### WebSocket

- **Постоянное соединение**: Однократное установление соединения, которое затем используется для всех запросов.
- **Меньший заголовок**: Сообщения содержат минимум служебной информации.

### REST API

- **Новое соединение на каждый запрос**: Требуется повторное TCP-рукопожатие и новые HTTP-заголовки.
- **Большие заголовки**: Каждый запрос содержит полный набор HTTP-заголовков.

**Сравнение размера передаваемых данных**:

- REST API запрос может содержать ~800-1000 байт заголовков для каждого запроса
- WebSocket сообщение после соединения может содержать всего лишь 2 байта накладных расходов на сообщение

## 3. Эффективность при частом обмене данными

### WebSocket

- **Оптимизация для частого обмена**: Малый размер служебной информации делает WebSocket эффективным для частых обновлений.
- **Снижение нагрузки на сеть**: Поскольку нет необходимости устанавливать новое соединение для каждого сообщения.

### REST API

- **Высокие накладные расходы**: При большом количестве небольших сообщений увеличивается объём передаваемых служебных данных.
- **Повышенная нагрузка на сервер**: Каждый запрос создаёт новые подключения и обработку HTTP-стека.

## 4. Состояние и контекст соединения

### WebSocket

- **Сохранение состояния**: WebSocket-соединения сохраняют контекст и могут поддерживать состояние между сообщениями.
- **Аутентификация один раз**: Аутентификация происходит при установке соединения и не требуется для каждого сообщения.

### REST API

- **Отсутствие состояния (Stateless)**: Каждый запрос независим, и сервер не хранит информацию о предыдущих запросах.
- **Повторная аутентификация**: Часто требуется отправлять информацию аутентификации с каждым запросом.

## 5. Подходит для определенных типов приложений

### WebSocket особенно полезен для:

- **Чаты и мессенджеры**: Мгновенная доставка сообщений.
- **Многопользовательские игры**: Быстрая синхронизация состояния игры.
- **Торговые и финансовые платформы**: Обновление котировок в реальном времени.
- **Коллаборативные инструменты**: Совместное редактирование документов.
- **Системы уведомлений**: Мгновенная доставка оповещений.

### REST API больше подходит для:

- **CRUD-операции**: Создание, чтение, обновление и удаление ресурсов.
- **Открытые API**: Предоставление доступа к данным внешним приложениям.
- **Страницы с редким обновлением**: Где данные обновляются редко или по запросу пользователя.

## 6. Производительность сервера

### WebSocket

- **Меньше подключений**: Одно долгоживущее соединение на клиента снижает нагрузку на сервер.
- **Эффективный memory footprint**: Может обрабатывать больше одновременных клиентов.

### REST API

- **Больше соединений**: Каждый запрос создает новое соединение, увеличивая нагрузку.
- **Более высокий расход ресурсов**: Установка новых соединений требует больше ресурсов сервера.

## 7. Пример сравнения в Node.js

### WebSocket-сервер на Node.js (с использованием ws):

```javascript
const WebSocket = require("ws")
const wss = new WebSocket.Server({ port: 8080 })

wss.on("connection", (ws) => {
  // Отправка данных клиенту каждую секунду
  const interval = setInterval(() => {
    ws.send(JSON.stringify({ time: new Date().toISOString() }))
  }, 1000)

  ws.on("message", (message) => {
    console.log(`Получено: ${message}`)
  })

  ws.on("close", () => {
    clearInterval(interval)
  })
})
```

### REST API на Node.js (с использованием Express):

```javascript
const express = require("express")
const app = express()

app.get("/time", (req, res) => {
  res.json({ time: new Date().toISOString() })
})

app.listen(3000, () => {
  console.log("REST API сервер запущен на порту 3000")
})
```

Для получения времени каждую секунду с REST API, клиенту пришлось бы делать запрос каждую секунду, создавая новое соединение каждый раз, в то время как WebSocket поддерживает одно соединение.

## Заключение

WebSocket обеспечивает преимущества в скорости, эффективности и функциональности для приложений, требующих обмена данными в реальном времени. Однако, REST API остается более простым в реализации и лучше подходит для традиционных веб-приложений с меньшей частотой обновлений.

Идеальный подход часто включает использование обеих технологий в рамках одного приложения: REST API для традиционных CRUD-операций и WebSocket для функциональности реального времени.

---

[[002 Node.js|Назад]]
