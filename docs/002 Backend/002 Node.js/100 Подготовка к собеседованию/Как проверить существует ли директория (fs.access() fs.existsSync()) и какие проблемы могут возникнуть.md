---
title: Как проверить существует ли директория (fs.access() fs.existsSync()) и какие проблемы могут возникнуть
draft: false
tags:
  - "#NodeJS"
  - "#fs"
  - "#файловая-система"
  - "#директории"
  - "#проверка-существования"
  - "#асинхронность"
info:
  - "[Документация Node.js по fs.access()](https://nodejs.org/api/fs.html#fs_fs_access_path_mode_callback)"
  - "[Документация Node.js по fs.existsSync()](https://nodejs.org/api/fs.html#fs_fs_existssync_path)"
  - "[Работа с файловой системой в Node.js](https://nodejs.dev/learn/the-nodejs-fs-module)"
---

### Как проверить, существует ли директория в Node.js?

Для проверки существования папки (директории) в Node.js можно использовать два метода:

- **Асинхронный**: `fs.access()`
- **Синхронный**: `fs.existsSync()`

---

## 1. Асинхронный метод: `fs.access()`

`fs.access()` проверяет доступность директории и требует **обработки ошибок**.

```javascript
const fs = require("fs")

fs.access("myFolder", fs.constants.F_OK, (err) => {
  if (err) {
    console.log("Директория не существует")
  } else {
    console.log("Директория существует")
  }
})
```

### Разбор:

- `fs.constants.F_OK` – проверяет, **существует ли файл/директория**.
- Если путь **не найден**, возникает ошибка `err`.

**Плюсы**:

- Не блокирует поток (асинхронный).
- Можно проверить **права доступа** (`R_OK`, `W_OK`).

**Минусы**:

- Требуется обработка ошибок.

---

## 2. Синхронный метод: `fs.existsSync()`

Этот метод **возвращает `true` или `false`**, если директория существует.

```javascript
const fs = require("fs")

if (fs.existsSync("myFolder")) {
  console.log("Директория существует")
} else {
  console.log("Директории нет")
}
```

**Плюсы**:

- Простой и удобный.
- Не требует обработки ошибок.

**Минусы**:

- **Блокирует выполнение** кода (нежелательно в асинхронных приложениях).

---

## Возможные проблемы:

1. **Race condition** (состояние гонки)
   - Если между `fs.existsSync()` и последующей операцией директория **удалится**, код может сломаться.
   - Лучше **сразу использовать `fs.access()` перед работой с файлом**.
2. **Файловые системы с нестандартным поведением**
   - На сетевых дисках или виртуальных файловых системах могут быть задержки.

---

### Итог:

- **`fs.access()`** – **рекомендуемый** метод, **не блокирует поток** (но требует обработку ошибок).
- **`fs.existsSync()`** – удобен, но **блокирует поток** (используйте в коротких CLI-скриптах).

**Лучший вариант** для большинства случаев: **использовать `fs.access()`**, если важна производительность.

---

[[002 Node.js|Назад]]
