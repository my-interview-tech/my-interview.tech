---
title: Что такое peerDependencies и в каких сценариях они используются
draft: false
tags:
  - "#NodeJS"
  - "#npm"
  - "#пакеты"
  - "#зависимости"
  - "#peerDependencies"
  - "#разработка-библиотек"
info:
  - "[Документация по peerDependencies](https://docs.npmjs.com/cli/v9/configuring-npm/package-json#peerdependencies)"
  - "[Руководство по работе с зависимостями npm](https://docs.npmjs.com/specifying-dependencies-and-devdependencies-in-a-package-json-file)"
  - "[Управление зависимостями в npm](https://nodejs.org/en/learn/getting-started/npm-dependencies-and-devdependencies)"
---

**`peerDependencies`** — это особый тип зависимостей в **`package.json`**, который указывает, что для правильной работы вашего пакета требуется наличие определённой версии другого пакета в проекте, но **не устанавливается** этим пакетом напрямую. В отличие от обычных зависимостей, **`peerDependencies`** должны быть установлены на более высоком уровне (в родительском проекте), и это важно для предотвращения конфликтов версий.

### Когда и зачем использовать `peerDependencies`?

1. **Библиотеки и плагины:**

   - `peerDependencies` чаще всего используются в **библиотеках**, **плагинах** или **инструментах**, которые должны работать с уже установленной версией другой библиотеки. Например, если вы пишете плагин для библиотеки **React**, вам нужно убедиться, что в проекте уже установлена версия **React**, которая совместима с вашим плагином.
   - Пример для плагина React:
     ```json
     "peerDependencies": {
       "react": "^17.0.0"
     }
     ```
     В этом случае плагин требует, чтобы в проекте была установлена версия **`react`** от **17.0.0** и выше, но сам React не будет установлен автоматически.

2. **Конфликт версий:**

   - **`peerDependencies`** позволяют избежать проблем с конфликтами версий, когда несколько пакетов требуют разных версий одной и той же библиотеки. Например, если два пакета, которые вы используете, требуют разных версий одной и той же библиотеки, `peerDependencies` может гарантировать, что проект будет использовать одну совместимую версию.

3. **Взаимозависимости между пакетами:**

   - В некоторых случаях библиотеки не могут работать с несколькими версиями одних и тех же зависимостей. Использование `peerDependencies` помогает указать, что зависимость должна быть установлена на верхнем уровне (в проекте), и это предотвращает установку разных версий одного пакета в разных частях проекта.

### Пример:

Предположим, что у вас есть пакет, который является плагином для **React**. Этот плагин должен работать только с определённой версией **React**, но сам React не должен быть установлен в качестве зависимости плагина:

```json
{
  "name": "my-react-plugin",
  "version": "1.0.0",
  "peerDependencies": {
    "react": "^17.0.0"
  }
}
```

- В этом примере плагин требует, чтобы в проекте был установлен **React** версии **`17.x.x`**. Однако сам React не будет установлен, потому что это не прямая зависимость, а **пировая** (peer) зависимость.

### Как работает `peerDependencies`:

- Когда вы устанавливаете пакет с **`peerDependencies`**, **npm** проверяет, установлен ли необходимый пакет с нужной версией. Если пакет не установлен или версия не соответствует требованиям, npm выведет предупреждение:
  ```
  npm WARN my-react-plugin@1.0.0 requires a peer of react@^17.0.0 but none is installed. You must install peer dependencies yourself.
  ```
- **`peerDependencies`** не заставляют npm автоматически устанавливать зависимость, как это происходит с **`dependencies`** или **`devDependencies`**. Вы должны вручную установить нужную версию зависимости в вашем проекте:
  ```bash
  npm install react@^17.0.0
  ```

### Отличие от `dependencies` и `devDependencies`:

- **`dependencies`**: Зависимости, которые будут установлены автоматически при установке вашего пакета, например, библиотеки, которые необходимы для работы приложения.
- **`devDependencies`**: Зависимости, нужные только для разработки (например, тестовые фреймворки, сборщики).
- **`peerDependencies`**: Зависимости, которые необходимы для совместимости с другими пакетами в проекте, но не устанавливаются автоматически. Они указывают, что ваш пакет должен работать с определённой версией другой зависимости, но эту зависимость должен установить сам пользователь проекта.

### Когда не стоит использовать `peerDependencies`?

- Если ваш пакет требует зависимости, которая должна быть установлена и работать непосредственно в рамках вашего пакета (и не зависит от внешнего проекта), то следует использовать **`dependencies`**, а не **`peerDependencies`**.
- Если версия зависимости не важна или если пакет не зависит от конкретной версии, то можно использовать **`dependencies`** для установки этой библиотеки напрямую.

### Заключение:

**`peerDependencies`** используются для того, чтобы указать, что ваш пакет работает с определённой версией другой зависимости, но она должна быть установлена внешним проектом, а не самим пакетом. Это особенно полезно для библиотек, плагинов или других пакетов, которые зависят от других библиотек, установленных в проекте.

---

[[002 Node.js|Назад]]
