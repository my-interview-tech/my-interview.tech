---
title: Чем отличается npm install lodash от npm install -g lodash
draft: false
tags:
  - "#NodeJS"
  - "#npm"
  - "#пакетный-менеджер"
  - "#установка-пакетов"
  - "#глобальные-пакеты"
info:
  - https://docs.npmjs.com/cli/v8/commands/npm-install
  - https://docs.npmjs.com/downloading-and-installing-packages-globally
  - https://habr.com/ru/companies/domclick/articles/510662/
---

Существует два основных способа установки пакетов через npm: локальная установка и глобальная установка с флагом `-g`. Эти способы имеют различное назначение и влияют на доступность и использование пакета.

## Локальная установка: `npm install lodash`

### Особенности:

1. **Место установки**:

   - Пакет устанавливается в директорию `node_modules` текущего проекта
   - Отдельная копия пакета для каждого проекта

2. **Доступность**:

   - Пакет доступен только в рамках текущего проекта
   - Импортируется через `require()` или `import` в JavaScript-файлах проекта

3. **package.json**:

   - Добавляется в список зависимостей проекта в `package.json` (с флагом `--save` или по умолчанию в новых версиях npm)
   - Устанавливается автоматически при `npm install` в новой копии проекта

4. **Типичное использование**:
   - Библиотеки и фреймворки, необходимые для работы конкретного проекта
   - Модули, от которых зависит код проекта

### Пример использования:

```javascript
// В файле проекта
const _ = require("lodash")
// или с ES modules
import _ from "lodash"

console.log(_.chunk(["a", "b", "c", "d"], 2)) // [['a', 'b'], ['c', 'd']]
```

## Глобальная установка: `npm install -g lodash`

### Особенности:

1. **Место установки**:

   - Пакет устанавливается в глобальную директорию npm, общую для всей системы
   - Обычно это `/usr/local/lib/node_modules` в Unix-системах или `C:\Users\{username}\AppData\Roaming\npm\node_modules` в Windows

2. **Доступность**:

   - Пакет доступен из любого проекта и любой директории на компьютере
   - CLI-инструменты добавляются в переменную PATH и доступны из командной строки

3. **package.json**:

   - НЕ добавляется в зависимости конкретного проекта
   - Не зависит от проекта и не отслеживается системами контроля версий

4. **Типичное использование**:
   - Утилиты командной строки и инструменты разработчика
   - Генераторы проектов и шаблонов
   - Инструменты автоматизации и сборки, используемые на глобальном уровне

### Пример глобально установленного инструмента:

```bash
# Установка инструмента create-react-app глобально
npm install -g create-react-app

# Теперь можно использовать команду из любой директории
create-react-app my-new-project
```

## Рекомендации по выбору метода установки

### Когда использовать локальную установку:

- Для библиотек и модулей, используемых в коде проекта
- Для сохранения совместимости между разными копиями проекта
- В большинстве случаев для стандартных зависимостей

```bash
npm install lodash express mongoose react
```

### Когда использовать глобальную установку:

- Для инструментов командной строки, используемых часто в разных проектах
- Для утилит, не привязанных к конкретному проекту
- Когда инструмент используется для создания или управления проектами

```bash
npm install -g nodemon prettier typescript eslint
```

## Проблемы и ограничения глобальных установок

1. **Управление версиями**:

   - При глобальной установке доступна только одна версия пакета, что может вызвать конфликты между проектами
   - Различные проекты могут требовать разные версии одного и того же инструмента

2. **Воспроизводимость**:

   - Глобальные зависимости не отслеживаются в `package.json`
   - Сложнее обеспечить одинаковое окружение для всех участников проекта

3. **Безопасность**:
   - Глобальные пакеты часто требуют повышенных привилегий для установки
   - Большее влияние потенциальных уязвимостей в глобальных пакетах

## Альтернативы глобальной установке

### 1. npx (начиная с npm 5.2+)

Позволяет выполнять пакеты, не устанавливая их глобально:

```bash
# Вместо глобальной установки
npx create-react-app my-app
```

### 2. Локальные инструменты через npm scripts

Установка инструментов локально и использование через npm-скрипты:

```json
// package.json
{
  "scripts": {
    "lint": "eslint .",
    "dev": "nodemon server.js"
  },
  "devDependencies": {
    "eslint": "^8.0.0",
    "nodemon": "^2.0.15"
  }
}
```

Затем используется:

```bash
npm run lint
npm run dev
```

## Заключение

- `npm install lodash` устанавливает пакет в текущий проект для использования в коде проекта
- `npm install -g lodash` устанавливает пакет глобально в системе для использования из любой директории

В современной практике рекомендуется минимизировать использование глобальных пакетов, предпочитая локальные установки и инструменты вроде npx для обеспечения лучшей совместимости, безопасности и воспроизводимости проектов.

---

[[003 JSCore|Назад]]
