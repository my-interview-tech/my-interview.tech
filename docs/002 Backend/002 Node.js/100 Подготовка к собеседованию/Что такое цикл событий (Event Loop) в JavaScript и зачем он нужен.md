---
title: Что такое цикл событий (Event Loop) в JavaScript и зачем он нужен
draft: false
tags:
  - "#JavaScript"
  - "#NodeJS"
  - "#EventLoop"
  - "#async"
  - "#однопоточность"
info:
  - https://habr.com/ru/articles/461401/
  - https://habr.com/ru/articles/680314/
  - https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick
---

**Event Loop (Цикл событий)** — это механизм, который позволяет JavaScript выполнять асинхронный код, несмотря на однопоточность движка. Он управляет выполнением кода, обрабатывает события и выполняет задания из очередей, организуя неблокирующую обработку операций ввода-вывода.

### Зачем нужен Event Loop:

1. **Неблокирующее выполнение** - позволяет не блокировать основной поток при асинхронных операциях (таймеры, I/O, сетевые запросы)
2. **Реактивное программирование** - делает возможной обработку событий в неблокирующем стиле
3. **Эффективное использование ресурсов** - помогает обрабатывать тысячи соединений с минимальными затратами ресурсов

### Как работает Event Loop в Node.js:

Event Loop в Node.js работает в следующем порядке (фазы):

1. **Таймеры (timers)** - выполнение колбэков setTimeout() и setInterval()
2. **Ожидающие колбэки (pending callbacks)** - выполнение отложенных операций ввода-вывода
3. **Подготовка (idle, prepare)** - только для внутреннего использования
4. **Опрос (poll)** - получение новых событий ввода-вывода, выполнение связанных с ними колбэков
5. **Проверка (check)** - выполнение колбэков setImmediate()
6. **Колбэки закрытия (close callbacks)** - обработчики закрытия, например socket.on('close', ...)

### Приоритет выполнения в Node.js:

1. **process.nextTick()** - выполняется сразу после завершения текущей операции, до начала следующей фазы цикла
2. **Promises (микрозадачи)** - выполняются после process.nextTick(), но до следующей фазы цикла
3. **Таймеры, I/O, setImmediate и другие задачи** - выполняются в соответствии с фазами цикла

### Пример работы Event Loop:

```javascript
console.log("1. Синхронный код") // Выполняется сразу

setTimeout(() => {
  console.log("2. setTimeout с нулевой задержкой") // Макрозадача (таймер)
}, 0)

Promise.resolve().then(() => {
  console.log("3. Promise (микрозадача)") // Микрозадача
})

process.nextTick(() => {
  console.log("4. process.nextTick()") // Наивысший приоритет
})

console.log("5. Ещё синхронный код") // Выполняется сразу

// Вывод будет в таком порядке:
// 1. Синхронный код
// 5. Ещё синхронный код
// 4. process.nextTick()
// 3. Promise (микрозадача)
// 2. setTimeout с нулевой задержкой
```

Event Loop делает возможным создание высокопроизводительных систем на JavaScript, позволяя обрабатывать тысячи одновременных операций без необходимости использования нескольких потоков или процессов.

---

[[003 JSCore|Назад]]
