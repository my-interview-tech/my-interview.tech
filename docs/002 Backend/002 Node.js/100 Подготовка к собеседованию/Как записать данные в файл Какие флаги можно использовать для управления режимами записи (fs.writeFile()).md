---
title: Как записать данные в файл Какие флаги можно использовать для управления режимами записи (fs.writeFile())
draft: false
tags:
  - "#NodeJS"
  - "#fs"
  - "#file-system"
  - "#writeFile"
  - "#IO"
info:
  - https://nodejs.org/api/fs.html#fswritefilefile-data-options-callback
  - https://nodejs.org/api/fs.html#file-system-flags
---

## Запись данных в файл в Node.js

Для записи данных в файл в Node.js используется метод `fs.writeFile()`. Он **перезаписывает** файл, если он уже существует.

```javascript
const fs = require("fs")

fs.writeFile("example.txt", "Hello, Node.js!", (err) => {
  if (err) {
    console.error("Ошибка записи:", err)
    return
  }
  console.log("Файл успешно записан!")
})
```

> **Важно:** Если файл **уже существует**, его содержимое будет **удалено и заменено** новыми данными.

## Управление режимами записи с помощью флагов

Метод `fs.writeFile()` принимает **третий аргумент** – объект настроек, где можно указать флаг `flag`:

```javascript
fs.writeFile("example.txt", "New data", { flag: "w" }, (err) => {
  if (err) throw err
})
```

### Основные флаги:

| **Флаг**             | **Описание**                                                |
| -------------------- | ----------------------------------------------------------- |
| `'w'` (по умолчанию) | Создает файл, если его нет, **перезаписывает** существующий |
| `'wx'`               | Записывает **только если файл не существует**, иначе ошибка |
| `'a'`                | Добавляет данные в **конец файла**, если файл существует    |
| `'ax'`               | Добавляет данные, но **только если файл не существует**     |
| `'r+'`               | Чтение + запись (ошибка, если файла нет)                    |
| `'w+'`               | Чтение + запись (перезапись файла)                          |
| `'a+'`               | Чтение + добавление (создаст файл, если его нет)            |

## Пример добавления данных в конец файла (`'a'`)

```javascript
fs.writeFile("example.txt", "\nAppended text", { flag: "a" }, (err) => {
  if (err) throw err
  console.log("Данные добавлены в файл")
})
```

> Флаг `'a'` не перезаписывает файл, а **добавляет** данные в конец.

## Альтернатива: `fs.appendFile()`

Для удобства Node.js предоставляет метод `fs.appendFile()`, который делает то же самое, что `fs.writeFile()` с `{ flag: 'a' }`:

```javascript
fs.appendFile("example.txt", "\nAnother line", (err) => {
  if (err) throw err
  console.log("Строка добавлена")
})
```

## Запись синхронно (блокирующая операция)

Если нужно записать данные **синхронно** (например, перед завершением программы), используйте `fs.writeFileSync()`:

```javascript
fs.writeFileSync("example.txt", "Sync write example")
console.log("Файл записан")
```

> **Не рекомендуется для асинхронных приложений**, так как блокирует выполнение кода.

## Вывод

- `fs.writeFile()` – **перезаписывает файл** (по умолчанию).
- `fs.writeFile()` с `{ flag: 'a' }` или `fs.appendFile()` – **добавляет данные** в конец файла.
- Флаги (`'w'`, `'a'`, `'r+'` и т.д.) позволяют **гибко управлять записью**.
- `fs.writeFileSync()` – **синхронная запись**, блокирует поток выполнения.
- Используйте асинхронные методы (`fs.writeFile()`, `fs.appendFile()`) для **оптимальной производительности**!

---

[[002 Node.js|Назад]]
