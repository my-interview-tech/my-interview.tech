---
title: Какие методы модуля fs блокируют главный поток Почему стоит избегать их в асинхронных приложениях
draft: true
tags: NodeJS
info:
---
Методы, оканчивающиеся на **`Sync`**, выполняются синхронно и блокируют главный поток выполнения.

Примеры:

- `fs.readFileSync(path, options)` – синхронное чтение файла
- `fs.writeFileSync(path, data, options)` – синхронная запись в файл
- `fs.appendFileSync(path, data, options)` – синхронное дополнение файла
- `fs.unlinkSync(path)` – синхронное удаление файла
- `fs.renameSync(oldPath, newPath)` – синхронное переименование
- `fs.mkdirSync(path, options)` – синхронное создание директории
- `fs.rmdirSync(path, options)` – синхронное удаление директории
- `fs.statSync(path)` – получение информации о файле
- `fs.copyFileSync(src, dest)` – копирование файла

Пример блокирующего кода:

js

КопироватьРедактировать

`const fs = require('fs');  console.log('Начало'); const data = fs.readFileSync('file.txt', 'utf-8'); console.log('Прочитано:', data); console.log('Конец');`

При выполнении **`fs.readFileSync()`** главный поток ждёт, пока файл полностью загрузится в память, прежде чем продолжить выполнение.

---

### **Почему стоит избегать синхронных методов в асинхронных приложениях**

1. **Блокировка главного потока**
    
    - Node.js работает на одном основном потоке.
    - Если выполнение останавливается на синхронном методе, сервер не может обрабатывать другие запросы.
2. **Падение производительности**
    
    - В асинхронном коде обработка файлов должна происходить без ожидания завершения операции.
3. **Низкая масштабируемость**
    
    - Если синхронные методы используются в веб-сервере, один медленный файл может задерживать все запросы.

---

### **Альтернативы – асинхронные методы**

Асинхронные методы не блокируют поток, так как используют колбэки, промисы или `async/await`.

Пример асинхронного чтения:

js

КопироватьРедактировать

`fs.readFile('file.txt', 'utf-8', (err, data) => {   if (err) throw err;   console.log('Прочитано:', data); }); console.log('Конец'); // Выведется раньше, чем данные из файла`

Асинхронный вариант с `promises`:

js

КопироватьРедактировать

`const fsPromises = require('fs/promises');  async function readFile() {   try {     const data = await fsPromises.readFile('file.txt', 'utf-8');     console.log('Прочитано:', data);   } catch (err) {     console.error(err);   } }  readFile(); console.log('Конец'); // Выведется раньше, чем данные из файла`

Использование `async`-методов позволяет выполнять операции параллельно, не блокируя поток выполнения.