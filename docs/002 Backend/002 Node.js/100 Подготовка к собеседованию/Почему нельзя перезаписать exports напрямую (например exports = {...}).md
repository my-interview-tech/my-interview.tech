---
title: Почему нельзя перезаписать exports напрямую (например exports = {...})
draft: true
tags: NodeJS
info:
---
В **Node.js** нельзя перезаписать объект `exports` напрямую, например, через `exports = {...}`, потому что это приведет к неожиданному поведению и не будет работать, как вы ожидаете. Причина заключается в том, что **`exports`** и **`module.exports`** изначально ссылаются на один и тот же объект, но после перезаписывания `exports` вы разрываете связь с `module.exports`.

### Почему это не работает?

1. **Изначальная связь между `exports` и `module.exports`:** Когда модуль загружается, `exports` и `module.exports` указывают на один и тот же объект. Это позволяет вам использовать `exports` для добавления свойств или методов в экспортируемый объект, а затем этот объект экспортируется с помощью `module.exports`.
    
    Пример:
    
    javascript
    
    КопироватьРедактировать
    
    `// module.js exports.greet = function() {   console.log('Hello!'); };`
    
    В этом случае `exports.greet` и `module.exports.greet` будут ссылаться на одну и ту же функцию, и Node.js правильно экспортирует объект с этим методом.
    
2. **Перезапись `exports` создает новый объект:** Когда вы пишете `exports = {...}`, вы создаете новый объект и присваиваете его переменной `exports`. Однако это не изменяет `module.exports`, так как они больше не ссылаются на один и тот же объект.
    
    Пример неправильного использования:
    
    javascript
    
    КопироватьРедактировать
    
    `// module.js exports = {   greet: function() {     console.log('Hello!');   } };`
    
    В этом примере `exports` теперь указывает на новый объект, но `module.exports` по-прежнему ссылается на старый объект, который был изначально. Таким образом, Node.js экспортирует старый объект (без изменений), а не новый, который вы создали.
    
3. **Правильный способ:** Чтобы изменить то, что экспортируется из модуля, вы должны изменять **`module.exports`**, а не перезаписывать `exports`.
    
    Пример правильного использования:
    
    javascript
    
    КопироватьРедактировать
    
    `// module.js module.exports = {   greet: function() {     console.log('Hello!');   } };`
    
    В этом случае `module.exports` будет экспортировать новый объект, и это будет правильно работать.
    

### Подытожим:

- `exports` и `module.exports` изначально ссылаются на один и тот же объект.
- Если вы присваиваете новое значение `exports`, это разрывает связь с `module.exports`, и Node.js не будет экспортировать новый объект.
- Чтобы изменить экспортируемое значение, всегда используйте **`module.exports`**, а не перезаписывайте `exports`.