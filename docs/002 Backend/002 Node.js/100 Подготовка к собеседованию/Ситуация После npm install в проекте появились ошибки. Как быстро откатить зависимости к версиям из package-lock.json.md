---
title: Ситуация После npm install в проекте появились ошибки. Как быстро откатить зависимости к версиям из package-lock.json
draft: false
tags:
  - "#NodeJS"
  - "#npm"
  - "#package-lock.json"
  - "#зависимости"
  - "#rollback"
  - "#npm-ci"
info:
  - "[Документация npm по команде npm ci](https://docs.npmjs.com/cli/v8/commands/npm-ci)"
  - "[Управление зависимостями в Node.js](https://nodejs.org/en/docs/guides/dependency-management/)"
  - "[Лучшие практики работы с package-lock.json](https://docs.npmjs.com/cli/v9/configuring-npm/package-lock-json)"
---

Если после выполнения **`npm install`** в проекте появились ошибки, и вы хотите откатить зависимости к версиям, зафиксированным в **`package-lock.json`**, выполните следующие шаги:

### 1. **Удалите текущие установленные зависимости**

Сначала удалите папку **`node_modules`** и файл **`package-lock.json`** (если нужно откатить зависимости к зафиксированным версиям, например, если файл был изменён вручную):

```bash
rm -rf node_modules
rm package-lock.json
```

### 2. **Восстановите зависимости из `package-lock.json`**

Теперь, чтобы восстановить зависимости точно такими, как они были в **`package-lock.json`**, просто выполните команду:

```bash
npm ci
```

Команда **`npm ci`** (Continuous Integration) гарантирует, что зависимости будут установлены точно по версии, зафиксированной в **`package-lock.json`**. В отличие от **`npm install`**, которая может изменять **`package-lock.json`**, **`npm ci`** работает с зафиксированными версиями и не изменяет файл блокировки.

**Преимущества использования `npm ci`:**

- Устанавливает зависимости точно в соответствии с **`package-lock.json`**.
- Быстрее, чем **`npm install`**, так как не проверяет версии пакетов и не обновляет **`package-lock.json`**.

### 3. **Если необходимо, повторно создайте `package-lock.json`**

Если **`package-lock.json`** был удалён и его нужно восстановить, можно снова выполнить **`npm install`** (это создаст новый **`package-lock.json`**):

```bash
npm install
```

Это создаст новый файл **`package-lock.json`** с точными версиями зависимостей, соответствующими версиям в **`node_modules`**.

### 4. **Решение проблем с несовместимыми версиями**

Если ошибки после установки были вызваны несовместимыми версиями зависимостей, стоит обратить внимание на:

- Проверку совместимости версий в **`package.json`** и **`package-lock.json`**.
- Ручное обновление или понижение версий зависимостей для устранения конфликтов.

### Заключение:

Для быстрого отката зависимостей к версиям из **`package-lock.json`**, используйте команду **`npm ci`**. Эта команда удаляет **`node_modules`**, восстанавливает зависимости точно по зафиксированным версиям и не изменяет файл блокировки.

---

[[002 Node.js|Назад]]
