---
title: Чем WebSocket отличается от HTTP
draft: false
tags:
  - "#NodeJS"
  - "#WebSocket"
  - "#HTTP"
  - "#сеть"
  - "#протоколы"
  - "#реальное-время"
info:
  - https://developer.mozilla.org/ru/docs/Web/API/WebSockets_API
  - https://habr.com/ru/companies/ruvds/articles/683894/
---

**WebSocket** и **HTTP** — это два разных протокола коммуникации для веб, имеющие ключевые различия в архитектуре и применении.

### Основные отличия WebSocket от HTTP:

1. **Направление взаимодействия**:

   - **HTTP**: Односторонний протокол "запрос-ответ". Клиент инициирует запрос, сервер отвечает и соединение закрывается.
   - **WebSocket**: Двунаправленный протокол с постоянным соединением. После установления связи и клиент, и сервер могут отправлять данные в любое время.

2. **Состояние соединения**:

   - **HTTP**: Stateless (без состояния). Каждый запрос независим от предыдущих.
   - **WebSocket**: Stateful (с сохранением состояния). Поддерживает постоянное соединение, которое остается открытым, пока клиент или сервер не закроет его.

3. **Производительность и накладные расходы**:

   - **HTTP**: Каждый запрос требует полного TCP-подключения, заголовков и "рукопожатия".
   - **WebSocket**: После первоначального подключения (через HTTP Upgrade) имеет минимальные накладные расходы на передачу данных.

4. **Инициирование передачи данных**:

   - **HTTP**: Только клиент может инициировать запрос.
   - **WebSocket**: И клиент, и сервер могут инициировать передачу данных.

5. **Механизм установления соединения**:
   - **HTTP**: Каждый запрос устанавливает новое соединение.
   - **WebSocket**: Начинается с HTTP-запроса с заголовком `Upgrade: websocket`, после чего протокол переключается на WebSocket.

### Пример WebSocket в Node.js:

Серверная часть (с использованием библиотеки `ws`):

```javascript
const WebSocket = require("ws")

// Создаем WebSocket-сервер на порту 8080
const wss = new WebSocket.Server({ port: 8080 })

// Обработка нового соединения
wss.on("connection", (ws) => {
  console.log("Новое соединение установлено")

  // Отправляем сообщение клиенту
  ws.send("Привет от сервера!")

  // Обработка входящих сообщений
  ws.on("message", (message) => {
    console.log(`Получено сообщение: ${message}`)

    // Отправляем ответное сообщение
    ws.send(`Вы отправили: ${message}`)
  })

  // Обработка закрытия соединения
  ws.on("close", () => {
    console.log("Соединение закрыто")
  })
})
```

Клиентская часть (браузер):

```javascript
// Подключаемся к WebSocket-серверу
const socket = new WebSocket("ws://localhost:8080")

// Обработка открытия соединения
socket.onopen = () => {
  console.log("Соединение установлено")
  socket.send("Привет от клиента!")
}

// Обработка входящих сообщений
socket.onmessage = (event) => {
  console.log(`Получено сообщение: ${event.data}`)
}

// Обработка ошибок
socket.onerror = (error) => {
  console.error("Ошибка WebSocket:", error)
}

// Обработка закрытия соединения
socket.onclose = () => {
  console.log("Соединение закрыто")
}
```

### Когда использовать WebSocket:

- **Приложения реального времени**: чаты, онлайн-игры, потоковые данные
- **Живые обновления**: биржевые котировки, спортивные результаты
- **Коллаборативные инструменты**: совместное редактирование
- **Уведомления в реальном времени**: мессенджеры, уведомления

### Когда использовать HTTP:

- **Традиционные веб-страницы**: запрос-ответ
- **RESTful API**: структурированный обмен данными
- **Передача файлов**: загрузка/скачивание данных
- **Простые запросы**: когда не требуется постоянное соединение

WebSocket дополняет HTTP, предоставляя эффективный протокол для двунаправленной коммуникации в реальном времени, в то время как HTTP остается предпочтительным для традиционных веб-запросов.

---

[[003 JSCore|Назад]]
