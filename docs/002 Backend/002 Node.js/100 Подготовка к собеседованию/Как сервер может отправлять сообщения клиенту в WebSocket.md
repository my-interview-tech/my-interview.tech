---
title: Как сервер может отправлять сообщения клиенту в WebSocket
draft: true
tags: NodeJS
info:
---
В WebSocket-соединении сервер может отправлять сообщения клиенту в любой момент, после того как соединение установлено. Это происходит с использованием метода **`send()`** объекта WebSocket, который представляет собой подключение клиента.

### Основные шаги:

1. **Создание WebSocket-соединения** на сервере.
2. **Отправка сообщения** клиенту с помощью метода `send()`.

### Пример серверной стороны (с использованием библиотеки `ws` в Node.js):

javascript

КопироватьРедактировать

`const WebSocket = require('ws');  // Создание WebSocket-сервера на порту 8080 const wss = new WebSocket.Server({ port: 8080 });  wss.on('connection', (ws) => {   console.log('Новое соединение установлено');    // Отправка сообщения клиенту при подключении   ws.send('Добро пожаловать на сервер!');    // Отправка сообщений через 5 секунд   setInterval(() => {     ws.send('Это сообщение отправлено сервером');   }, 5000);    // Обработка сообщений от клиента   ws.on('message', (message) => {     console.log('Получено сообщение от клиента:', message);   }); });`

### Пример клиентской стороны (с использованием WebSocket API в браузере):

javascript

КопироватьРедактировать

`// Создание WebSocket-соединения с сервером const ws = new WebSocket('ws://localhost:8080');  // Обработка открытия соединения ws.onopen = () => {   console.log('Соединение с сервером установлено'); };  // Обработка полученных сообщений от сервера ws.onmessage = (event) => {   console.log('Сообщение от сервера:', event.data); };  // Отправка сообщения на сервер ws.send('Привет, сервер!');`

### Как сервер отправляет сообщения клиенту:

- Сервер может отправлять сообщения клиенту в любое время, используя метод **`ws.send(data)`**, где `data` — это строка, буфер или объект (обычно сериализованный в JSON).
- В примере выше сервер отправляет сообщение сразу после установления соединения и каждые 5 секунд.

### Примечания:

- Сервер может отправлять сообщения одновременно многим клиентам, если он настроен на работу с несколькими подключениями.
- Сервер может также отправлять сообщения в ответ на действия или запросы клиентов, или по расписанию, как показано в примере с `setInterval()`.

С помощью таких механизмов WebSocket-серверы могут поддерживать двустороннюю связь с клиентами и отправлять сообщения в реальном времени.