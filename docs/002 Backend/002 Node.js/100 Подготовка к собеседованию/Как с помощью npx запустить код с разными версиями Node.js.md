---
title: Как с помощью npx запустить код с разными версиями Node.js
draft: false
tags:
  - "#NodeJS"
  - "#npx"
  - "#nvm"
  - "#n"
  - "#версии"
  - "#управление-версиями"
info:
  - "[Документация npx](https://docs.npmjs.com/cli/v9/commands/npx)"
  - "[Документация nvm](https://github.com/nvm-sh/nvm)"
  - "[Документация n](https://github.com/tj/n)"
---

## Запуск кода с разными версиями Node.js

Чтобы с помощью **`npx`** запустить код с разными версиями **Node.js**, необходимо использовать утилиту **`npx`** совместно с менеджером версий Node.js, например **`nvm`** или **`n`**.

## Основные подходы

1. **Использование менеджера версий** — наиболее практичный подход, который позволяет легко переключаться между различными версиями Node.js.
2. **Комбинирование `npx` с менеджером версий** — даёт возможность запускать пакеты в контексте конкретной версии Node.js.

## Использование npx с nvm (Node Version Manager)

**`nvm`** — это популярный менеджер версий **Node.js**, который позволяет легко переключаться между версиями **Node.js**.

### Установка nvm

Для установки **`nvm`** следуйте инструкциям в официальном репозитории: [https://github.com/nvm-sh/nvm](https://github.com/nvm-sh/nvm)

```bash
# Пример установки nvm на macOS/Linux
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.3/install.sh | bash
```

### Шаги для запуска с определенной версией Node.js:

1. **Установите нужную версию Node.js через nvm**:

```bash
nvm install 14.17.0
```

2. **Переключитесь на нужную версию Node.js**:

```bash
nvm use 14.17.0
```

3. **Запустите npx с этой версией Node.js**:

```bash
npx cowsay "Использую Node.js 14.17.0"
```

### Запуск в одну команду

Вы можете использовать **`nvm exec`**, чтобы выполнить команду с определенной версией Node.js:

```bash
nvm exec 14.17.0 npx cowsay "Использую Node.js 14.17.0"
```

Или создать алиас в вашем shell:

```bash
# В ~/.bashrc или ~/.zshrc
alias npx14="nvm exec 14.17.0 npx"

# Затем используйте:
npx14 cowsay "Использую Node.js 14.17.0"
```

## Использование npx с n (Node Version Manager)

**`n`** — это более простой менеджер для управления версиями **Node.js**.

### Установка n

```bash
npm install -g n
```

### Шаги для запуска с определенной версией Node.js:

1. **Установите нужную версию Node.js через n**:

```bash
n 14.17.0
```

2. **Переключитесь и запустите npx**:

После переключения на нужную версию с помощью **`n`**, вы можете напрямую использовать **`npx`**:

```bash
n 14.17.0 && npx cowsay "Использую Node.js 14.17.0"
```

### Запуск определенной версии напрямую

**`n`** также позволяет напрямую выполнять команды с конкретной версией:

```bash
n exec 14.17.0 npx cowsay "Использую Node.js 14.17.0"
```

## Практические примеры использования

### Тестирование совместимости с разными версиями

Часто нужно проверить, работает ли ваш код с разными версиями Node.js:

```bash
# Скрипт для тестирования с разными версиями
#!/bin/bash

versions=("12.22.12" "14.17.0" "16.15.1" "18.12.1")

for version in "${versions[@]}"; do
  echo "Testing with Node.js $version"
  nvm exec $version node your-script.js
done
```

### Запуск проекта с версией, указанной в package.json

Если в вашем проекте указана нужная версия Node.js в поле `engines`:

```bash
# В package.json
# {
#   "engines": {
#     "node": ">=14.0.0 <16.0.0"
#   }
# }

# Установка версии в диапазоне
nvm install 14
# Использование версии
nvm use 14
# Запуск с npx
npx your-package
```

## Ограничения и особенности

1. **`npx` сам по себе не управляет версиями Node.js** — он только исполняет пакеты. Для управления версиями Node.js нужен отдельный инструмент.
2. **Необходимость предварительной установки** — прежде чем запустить код с определенной версией, эта версия должна быть установлена через `nvm` или `n`.
3. **Платформозависимость** — `nvm` не имеет официальной поддержки для Windows (хотя есть аналог nvm-windows), а `n` работает только на Unix-подобных системах.

## Заключение

Комбинирование **`npx`** с менеджерами версий **`nvm`** или **`n`** позволяет гибко запускать код с разными версиями Node.js. Это особенно полезно для тестирования совместимости, работы с разными проектами, которые требуют разных версий Node.js, и для разработки пакетов, которые должны поддерживать широкий спектр версий.

---

[[002 Node.js|Назад]]
