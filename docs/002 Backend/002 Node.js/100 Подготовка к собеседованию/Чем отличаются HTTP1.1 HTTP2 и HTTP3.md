---
title: Чем отличаются HTTP/1.1, HTTP/2 и HTTP/3
draft: false
tags:
  - "#NodeJS"
  - "#HTTP"
  - "#HTTP2"
  - "#HTTP3"
  - "#производительность"
  - "#протоколы"
info:
  - https://developer.mozilla.org/ru/docs/Web/HTTP/Basics_of_HTTP
  - https://habr.com/ru/articles/731984/
  - https://blog.cloudflare.com/ru-ru/http3-the-past-present-and-future-ru-ru/
---

**HTTP (Hypertext Transfer Protocol)** - это протокол прикладного уровня для передачи гипертекстовых документов. Разные версии протокола имеют существенные отличия в архитектуре и производительности.

## HTTP/1.1 (1997)

### Особенности:

- **Текстовый протокол** - запросы и ответы передаются в текстовом формате
- **Блокирующие запросы** - ожидание ответа перед отправкой следующего запроса (head-of-line blocking)
- **Постоянные соединения** - поддержка keep-alive для повторного использования TCP-соединений
- **Параллельные соединения** - браузеры открывают несколько TCP-соединений (обычно 6-8) для обхода блокировки запросов

### Ограничения:

- **Низкая эффективность** - каждый запрос содержит повторяющиеся HTTP-заголовки
- **Проблемы производительности** - при потере пакета блокируется весь поток данных
- **Высокая задержка** - медленная загрузка при большом количестве ресурсов

```
Client                Server
   |                    |
   |----GET /page------>|
   |<---HTML response---|
   |                    |
   |----GET /css------->|
   |<---CSS response----|
   |                    |
   |----GET /image1---->|
   |<---Image response--|
```

## HTTP/2 (2015)

### Особенности:

- **Бинарный протокол** - данные передаются в бинарном формате, а не текстовом
- **Мультиплексирование** - несколько запросов и ответов могут передаваться одновременно в одном TCP-соединении
- **Сжатие заголовков** - уменьшение объема передаваемых данных с помощью HPACK
- **Server Push** - сервер может отправлять ресурсы клиенту до того, как клиент их запросит
- **Приоритизация потоков** - возможность указать приоритет для разных запросов

### Преимущества:

- **Повышение производительности** - загрузка страниц в 1.5-2 раза быстрее, чем в HTTP/1.1
- **Эффективность использования соединений** - одно TCP-соединение для всех ресурсов
- **Снижение задержек** - параллельная загрузка множества ресурсов

```
Client                Server
   |                    |
   |-----HTTP/2 streams-----|
   |<------------------->|
   |      (multiple      |
   |    requests and     |
   |     responses       |
   |    concurrently)    |
   |<------------------->|
```

## HTTP/3 (2022)

### Особенности:

- **Транспорт QUIC вместо TCP** - протокол на основе UDP
- **Встроенное шифрование** - TLS 1.3 встроен непосредственно в протокол
- **Улучшенное мультиплексирование** - независимые потоки данных, устраняющие блокировку на уровне транспорта
- **Миграция соединений** - возможность менять сети (например, с Wi-Fi на мобильную сеть) без потери соединения
- **Сокращение времени установки соединения** - 0-RTT или 1-RTT вместо 3-RTT в HTTP/2

### Преимущества:

- **Устойчивость к потере пакетов** - проблемы в одном потоке не влияют на другие потоки
- **Лучшая производительность в мобильных сетях** - быстрое восстановление после потери соединения
- **Более низкая задержка** - особенно заметно при инициализации соединения

```
Client                Server
   |                    |
   |-----QUIC/UDP-------|
   |<------------------->|
   |      (multiple      |
   |    independent      |
   |      streams)       |
   |<------------------->|
```

## Использование в Node.js

### HTTP/1.1

```javascript
const http = require("http")

const server = http.createServer((req, res) => {
  res.writeHead(200, { "Content-Type": "text/plain" })
  res.end("Hello World\n")
})

server.listen(3000)
```

### HTTP/2

```javascript
const http2 = require("http2")
const fs = require("fs")

const server = http2.createSecureServer({
  key: fs.readFileSync("server.key"),
  cert: fs.readFileSync("server.crt"),
})

server.on("stream", (stream, headers) => {
  stream.respond({
    "content-type": "text/plain",
    ":status": 200,
  })
  stream.end("Hello World")
})

server.listen(3000)
```

### HTTP/3

```javascript
// Для HTTP/3 обычно используются сторонние библиотеки,
// так как нативной поддержки в Node.js пока нет
const quiche = require("quiche") // Пример библиотеки

const server = quiche.createServer({
  key: fs.readFileSync("server.key"),
  cert: fs.readFileSync("server.crt"),
})

server.on("request", (req, res) => {
  res.writeHead(200, { "Content-Type": "text/plain" })
  res.end("Hello World\n")
})

server.listen(3000)
```

Выбор версии протокола HTTP зависит от требований к производительности приложения, целевой аудитории и инфраструктуры. Современные приложения на Node.js всё чаще используют HTTP/2, а HTTP/3 постепенно набирает популярность для приложений, требующих максимальной производительности и устойчивости к проблемам сети.

---

[[003 JSCore|Назад]]
