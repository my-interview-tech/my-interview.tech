---
title: Создайте дуплексный поток который логирует все полученные данные.
draft: true
tags: NodeJS
info:
---
Для создания дуплексного потока, который логирует все полученные данные, можно использовать `stream.Transform`. Этот поток будет передавать данные дальше, одновременно записывая их в лог.

### **Код дуплексного потока:**

js

КопироватьРедактировать

`const { Transform } = require('stream');  class LoggingStream extends Transform {   _transform(chunk, encoding, callback) {     console.log('Лог:', chunk.toString());     this.push(chunk); // Передаем данные дальше     callback();   } }  module.exports = LoggingStream;`

### **Пример использования:**

js

КопироватьРедактировать

`const fs = require('fs'); const LoggingStream = require('./LoggingStream');  const readStream = fs.createReadStream('input.txt'); const writeStream = fs.createWriteStream('output.txt'); const logStream = new LoggingStream();  readStream.pipe(logStream).pipe(writeStream);`

### **Как это работает:**

1. **`_transform(chunk, encoding, callback)`** – метод, который вызывается для обработки каждого чанка данных.
2. **`console.log(chunk.toString())`** – логирует данные в консоль.
3. **`this.push(chunk)`** – передает данные дальше по потоку.
4. **`pipe()`** – соединяет потоки: данные читаются из `input.txt`, логируются и записываются в `output.txt`.

### **Преимущества:**

- **Потоковая обработка** – данные логируются без задержек.
- **Экономия памяти** – обработка чанками, без загрузки всего файла в память.
- **Гибкость** – можно использовать в цепочке с другими потоками (например, сжатие, шифрование).