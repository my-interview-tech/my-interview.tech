---
title: Как работает engines в package.json Что произойдет если версия Node.js не соответствует указанной
draft: false
tags:
  - "#NodeJS"
  - "#npm"
  - "#package.json"
  - "#engines"
  - "#версии"
  - "#зависимости"
info:
  - "[Документация npm по полю engines](https://docs.npmjs.com/cli/v9/configuring-npm/package-json#engines)"
  - "[Семантическое версионирование пакетов](https://semver.org/lang/ru/)"
  - "[Управление версиями Node.js](https://nodejs.org/en/download/releases/)"
---

Поле **`engines`** в файле **`package.json`** позволяет указать, какие версии Node.js (или других окружений) требуются для вашего проекта. Это помогает гарантировать, что приложение будет работать в нужной версии Node.js, так как разные версии Node.js могут поддерживать различные API и функционал.

## Пример использования

```json
{
  "name": "my-project",
  "version": "1.0.0",
  "engines": {
    "node": ">=14.0.0"
  }
}
```

Здесь указано, что проект требует **Node.js** версии 14.0.0 или выше.

## Как работает поле `engines`?

### Синтаксис и варианты указания версий

В **`engines`** можно указать минимальные и максимальные версии Node.js, поддерживаемые проектом:

- **Минимальная версия**: `"node": ">=14.0.0"` — проект поддерживает версии Node.js начиная с 14.0.0.
- **Диапазон версий**: `"node": ">=14.0.0 <16.0.0"` — проект поддерживает версии от 14.0.0 до 16.0.0 (не включая 16.0.0).
- **Точная версия**: `"node": "14.17.0"` — проект работает только с конкретной версией Node.js.

### Поддержка других платформ

Помимо **Node.js**, поле **`engines`** можно использовать для указания версий других платформ, например, **npm**:

```json
"engines": {
  "node": ">=14.0.0",
  "npm": ">=6.0.0"
}
```

## Что произойдет, если версия Node.js не соответствует указанной?

### В npm (до версии 7)

Если вы пытаетесь установить пакет, но ваша версия Node.js не соответствует указанной в **`engines`**, то **npm** не будет блокировать установку пакета, но покажет **предупреждение**:

```
npm WARN my-project@1.0.0 No repository field.
npm WARN my-project@1.0.0 The engine "node" is incompatible with this module. Expected version ">=14.0.0".
```

**npm** не запрещает установку, но предупредит пользователя о несовпадении версий, и установка продолжится.

### В npm (версия 7+)

С npm 7 и выше, вы можете установить флаг `engine-strict`, чтобы npm блокировал установку при несовпадении версий:

```json
// .npmrc
engine-strict=true
```

Или выполнить команду:

```bash
npm config set engine-strict true
```

### В Yarn

В отличие от **npm**, **Yarn** по умолчанию блокирует установку, если версия Node.js не соответствует требуемой. То есть если версия Node.js не соответствует требованиям в **`engines`**, установка будет остановлена с ошибкой.

Можно обойти это ограничение с помощью флага `--ignore-engines`:

```bash
yarn install --ignore-engines
```

## Как проверить версию Node.js?

Вы можете легко проверить текущую версию Node.js с помощью команды:

```bash
node -v
```

Если ваша версия не соответствует требованиям, вы можете использовать **`nvm`** (Node Version Manager) для установки и переключения между версиями Node.js:

```bash
# Установка nvm (для Unix/macOS систем)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# Установка конкретной версии Node.js
nvm install 14.17.0

# Использование установленной версии
nvm use 14.17.0
```

## Пример с ошибкой

Если вы установили проект, но ваша версия Node.js ниже минимально требуемой, **npm** покажет предупреждение, но установит зависимости:

```bash
npm WARN my-project@1.0.0 The engine "node" is incompatible with this module. Expected version ">=14.0.0".
```

Если проект не совместим с вашей версией Node.js, вы можете столкнуться с проблемами при запуске, например, с ошибками выполнения или недоступностью некоторых функций.

## Заключение

Поле **`engines`** в **`package.json`** позволяет:

1. **Указать требуемую версию Node.js** для корректной работы проекта.
2. **Предотвратить запуск проекта** на несовместимых версиях (при использовании `engine-strict` или Yarn).
3. **Документировать требования** к среде выполнения для других разработчиков.

Реакция на несоответствие версий зависит от менеджера пакетов:

- **npm**: по умолчанию показывает предупреждение.
- **npm с engine-strict**: блокирует установку.
- **Yarn**: по умолчанию блокирует установку.

Это помогает избежать проблем совместимости и обеспечить корректную работу проекта на подходящих версиях Node.js.

---

[[002 Node.js|Назад]]
